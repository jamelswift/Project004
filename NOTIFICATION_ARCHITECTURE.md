# ğŸ—ï¸ Notification System Architecture

## System Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   IoT SENSOR MANAGEMENT SYSTEM               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚  ESP32 Device   â”‚
                          â”‚   (IoT Device)  â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                    Sends sensor data (temperature, humidity)
                                   â”‚
                                   â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   POST /api/sensors      â”‚
                    â”‚  { sensorId, deviceId,   â”‚
                    â”‚    sensorType, value }   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Backend (Express + Node.js) â”‚
                    â”‚   Port: 5001                 â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                         â”‚
                â–¼                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Update Sensor Value   â”‚  â”‚  Check Threshold Logic   â”‚
    â”‚  db.sensors[index]     â”‚  â”‚ checkThresholdAndCreate â”‚
    â”‚                        â”‚  â”‚Alert(deviceId, type,val)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚                  â”‚                  â”‚
                        â–¼                  â–¼                  â–¼
                    Value OK        Value > Max         Value < Min
                 (No alert)         (Critical)          (Warning)
                        â”‚                â”‚                    â”‚
                        â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚                         â”‚
                        â”‚                         â–¼
                        â”‚                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚                â”‚ Create Notification  â”‚
                        â”‚                â”‚ Object               â”‚
                        â”‚                â”‚ id, deviceId,        â”‚
                        â”‚                â”‚ message (Thai),      â”‚
                        â”‚                â”‚ level, value, time   â”‚
                        â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚                           â”‚
                        â”‚                           â–¼
                        â”‚                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚                â”‚ Add to In-Memory DB  â”‚
                        â”‚                â”‚ db.notifications     â”‚
                        â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚                           â”‚
                        â”‚                           â–¼
                        â”‚                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚                â”‚ Log to DynamoDB      â”‚
                        â”‚                â”‚ (if available)       â”‚
                        â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚                           â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Response to Client     â”‚
                            â”‚ { success: true,        â”‚
                            â”‚   sensor: {...},        â”‚
                            â”‚   thresholdCheck: {...} â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚    Frontend (Next.js)       â”‚
                       â”‚    Port: 3000               â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    GET /api/alerts/unread (every 5-30 sec)
                                    â”‚
                                    â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  NotificationCenter Component  â”‚
                    â”‚  - Display alerts list         â”‚
                    â”‚  - Show unread count           â”‚
                    â”‚  - Mark as read               â”‚
                    â”‚  - Delete notification         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚  User Interface          â”‚
                       â”‚  /dashboard/alerts       â”‚
                       â”‚  - Tab 1: Notifications  â”‚
                       â”‚  - Tab 2: Thresholds     â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow for Notification Creation

```
SENSOR DATA ARRIVAL
        â”‚
        â–¼
    POST /api/sensors
    â”œâ”€ sensorId (required)
    â”œâ”€ deviceId (optional, for threshold check)
    â”œâ”€ sensorType (optional, for threshold check)
    â””â”€ value (required)
        â”‚
        â–¼
    Database Update
    db.sensors[index].value = value
    db.sensors[index].timestamp = now
        â”‚
        â–¼
    Threshold Check (if deviceId & sensorType provided)
        â”‚
        â”œâ”€ Query: getThresholdsByDevice(deviceId)
        â”‚         Filter: sensorType match
        â”‚
        â”œâ”€ Compare: value vs threshold
        â”‚   â”œâ”€ value < minValue? â†’ Create WARNING alert
        â”‚   â”œâ”€ value > maxValue? â†’ Create CRITICAL alert
        â”‚   â””â”€ value OK?         â†’ No alert
        â”‚
        â–¼
    Notification Created (if threshold exceeded)
        â”œâ”€ ID: alert-{timestamp}-{random}
        â”œâ”€ DeviceID: from request
        â”œâ”€ Message: Thai language message
        â”œâ”€ Level: critical | warning | info
        â”œâ”€ Value: sensor value that triggered
        â”œâ”€ Time: ISO timestamp
        â””â”€ isRead: false
        â”‚
        â–¼
    Store in Memory
    db.notifications.push(notification)
        â”‚
        â–¼
    Try to Log to Database
    logNotification(dynamoDb, ...)
        â”‚
        â–¼
    Return Response
    {
      success: true,
      sensor: {...},
      thresholdCheck: {
        alertCreated: true,
        notification: {...}
      }
    }
```

## Frontend Polling Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Component Load â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Initial Data Fetch      â”‚
â”‚  GET /api/alerts/unread  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Display Notifications   â”‚
â”‚  in List                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Start Interval Timer    â”‚
â”‚  (5-30 seconds)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Every Interval:               â”‚
    â”‚  GET /api/alerts/unread        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Update State:                 â”‚
    â”‚  setNotifications(newData)      â”‚
    â”‚  setUnreadCount(count)          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Re-render Component            â”‚
    â”‚  with new notifications         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€ Continue polling â”€â”€â”€â”€â”€â”€â”
                                         â”‚
                                         â–¼
                                  (Every 5-30 sec)
```

## Threshold Check Decision Tree

```
                    POST /api/sensors
                           â”‚
                           â–¼
                â”Œâ”€ deviceId provided?
                â”‚
                â”œâ”€ NO  â†’ Return sensor update
                â”‚        No threshold check
                â”‚
                â””â”€ YES â”
                        â”œâ”€ sensorType provided?
                        â”‚
                        â”œâ”€ NO  â†’ Return sensor update
                        â”‚        No threshold check
                        â”‚
                        â””â”€ YES â”
                                â”œâ”€ value is number?
                                â”‚
                                â”œâ”€ NO  â†’ Return sensor update
                                â”‚        No threshold check
                                â”‚
                                â””â”€ YES â”
                                        â”œâ”€ Get thresholds for device
                                        â”‚
                                        â”œâ”€ threshold found & enabled?
                                        â”‚
                                        â”œâ”€ NO  â†’ No alert
                                        â”‚
                                        â””â”€ YES â”
                                                â”œâ”€ minValue defined?
                                                â”‚ â”œâ”€ value < minValue?
                                                â”‚ â”‚ â””â”€ YES â†’ WARNING alert
                                                â”‚ â””â”€ NO â†’ continue
                                                â”‚
                                                â”œâ”€ maxValue defined?
                                                â”‚ â”œâ”€ value > maxValue?
                                                â”‚ â”‚ â””â”€ YES â†’ CRITICAL alert
                                                â”‚ â””â”€ NO â†’ continue
                                                â”‚
                                                â””â”€ Value OK, no alert
```

## API Sequence Diagram

```
Client              Backend             Database
  â”‚                   â”‚                    â”‚
  â”‚â”€ POST /thresholdsâ”€>â”‚                    â”‚
  â”‚                   â”‚â”€ Create threshold â”€>â”‚
  â”‚                   â”‚<â”€ Created â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚<â”€ 200 OK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚
  â”‚                   â”‚                    â”‚
  â”‚â”€ POST /sensors â”€â”€â”€>â”‚                    â”‚
  â”‚  (with deviceId,   â”‚                    â”‚
  â”‚   sensorType)      â”‚                    â”‚
  â”‚                   â”‚â”€ Get thresholds â”€â”€â”€>â”‚
  â”‚                   â”‚<â”€ Thresholds â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                   â”‚                    â”‚
  â”‚                   â”‚â”€ Compare value â”€â”€â”€â”€â”€â”
  â”‚                   â”‚ (in memory)         â”‚
  â”‚                   â”‚                    â”‚
  â”‚                   â”‚â”€ Create alert â”€â”€â”€â”€â”€â”€>â”‚ (optional)
  â”‚                   â”‚                    â”‚
  â”‚<â”€ 200 OK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚
  â”‚  (with threshold  â”‚                    â”‚
  â”‚   check result)   â”‚                    â”‚
  â”‚                   â”‚                    â”‚
  â”‚â”€ GET /alerts/unreadâ”€>â”‚                  â”‚
  â”‚                   â”‚â”€ Query alerts â”€â”€â”€â”€â”€>â”‚
  â”‚                   â”‚<â”€ Alerts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚<â”€ 200 OK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚
  â”‚  (alert list)     â”‚                    â”‚
  â”‚                   â”‚                    â”‚
  â”‚â”€ PUT /alerts/:id/readâ”€>â”‚               â”‚
  â”‚                   â”‚â”€ Update alert â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                   â”‚<â”€ Updated â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚<â”€ 200 OK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚
  â”‚                   â”‚                    â”‚
  â”‚â”€ DELETE /alerts/:idâ”€â”€>â”‚               â”‚
  â”‚                   â”‚â”€ Delete alert â”€â”€â”€â”€â”€>â”‚
  â”‚                   â”‚<â”€ Deleted â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚<â”€ 200 OK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚
```

## Component Interaction Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           /app/dashboard/alerts/page.tsx               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚                   â”‚                   â”‚
             â–¼                   â–¼                   â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚   Alerts     â”‚    â”‚Thresholds    â”‚   â”‚  Device      â”‚
      â”‚   Tab View   â”‚    â”‚  Tab View    â”‚   â”‚  Selector    â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                   â”‚                   â”‚
             â–¼                   â–¼                   â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ NotificationCenter   â”‚  â”‚ ThresholdSettings    â”‚
      â”‚ - List alerts        â”‚  â”‚ - Create threshold   â”‚
      â”‚ - Mark as read       â”‚  â”‚ - Edit threshold     â”‚
      â”‚ - Delete             â”‚  â”‚ - Delete threshold   â”‚
      â”‚ - Unread count       â”‚  â”‚ - Enable/disable     â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                         â”‚
             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚              â”‚
             â–¼              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚   Notification Library         â”‚
      â”‚   lib/notifications.ts         â”‚
      â”‚ - getUnreadNotifications()     â”‚
      â”‚ - getThresholdsByDevice()      â”‚
      â”‚ - markNotificationAsRead()     â”‚
      â”‚ - createThreshold()            â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Backend API            â”‚
         â”‚  http://localhost:5001  â”‚
         â”‚                         â”‚
         â”‚  /api/alerts/*          â”‚
         â”‚  /api/thresholds/*      â”‚
         â”‚  /api/sensors           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Notification Object Schema

```json
{
  "id": "alert-1704000000000-abc123def",
  
  // Device & Sensor Information
  "deviceId": "ESP32_001",
  "sensorType": "temperature",
  
  // Alert Message (Thai language)
  "message": "ğŸš¨ temperature à¹€à¸à¸´à¸™à¸‚à¸µà¸”à¸ˆà¸³à¸à¸±à¸”: à¸„à¹ˆà¸² 38 à¹€à¸à¸´à¸™à¸à¸§à¹ˆà¸² 35",
  
  // Severity Level
  "level": "critical",  // "critical" | "warning" | "info"
  
  // Sensor Value that triggered alert
  "value": 38,
  
  // Threshold that was exceeded
  "threshold": {
    "minValue": 15,
    "maxValue": 35,
    "enabled": true
  },
  
  // Timestamp (ISO format)
  "time": "2024-01-01T12:00:00.000Z",
  
  // Read status
  "isRead": false
}
```

## HTTP Status Codes

| Status | Meaning | Example |
|--------|---------|---------|
| 200 | OK | GET /api/alerts/unread |
| 201 | Created | POST /api/thresholds |
| 400 | Bad Request | Missing required field |
| 404 | Not Found | Threshold ID not found |
| 500 | Server Error | Database error |

---

**Last Updated**: 2024
**System Version**: 1.0.0
**Language**: Thai (à¸ à¸²à¸©à¸²à¹„à¸—à¸¢)
